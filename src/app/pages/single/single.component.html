<div>
  <!-- ############ -->
  <!-- ### Card ## -->
  <!-- ############ -->
  <div
    class="flex h-fit flex-col gap-1"
    *ngIf="singleItem$ | async as item; else loadingOrError"
  >
    <div
      class="relative flex h-80 w-full gap-3 rounded bg-card shadow-sm shadow-detail"
    >
      <div class="h-full w-1/4">
        <img
          class="h-full w-full rounded-l object-cover object-center"
          [src]="item.cover"
        />
        <div
          class="absolute bottom-3 left-3 h-fit w-fit p-px"
          tooltip="Clique para editar o item"
          color="card"
          [border]="true"
        >
          <div
            class="hover-basic flex h-6 w-6 cursor-pointer items-center justify-center rounded-full border border-secondary bg-main"
            (click)="onEdit()"
          >
            <ng-icon
              class="text-xs text-secondary"
              name="heroPencilMini"
            ></ng-icon>
          </div>
        </div>
      </div>
      <div class="flex flex-col gap-3 p-3">
        <div class="flex items-center gap-3">
          <app-star-rating class="h-6" [static]="item.rating"></app-star-rating>
          <div
            class="flex items-center gap-3 rounded border-highlight px-2 py-1 shadow-sm shadow-detail"
            *ngIf="!(entry === 'albums')"
          >
            <ng-icon
              class="text-xl text-highlight"
              [name]="entry === 'films' ? 'heroFilmSolid' : 'heroBookOpenSolid'"
            ></ng-icon>
            <h3 class="text-xl font-normal text-highlight">
              {{ (item | as : BookModel : FilmModel).status }}
            </h3>
          </div>
        </div>
        <h1 class="text-5xl font-extrabold text-secondary">
          {{ item.title }}
        </h1>
        <div class="flex flex-col">
          <h2 class="text-2xl font-semibold text-highlight">
            {{
              entry === "albums"
                ? (item | as : AlbumModel).artist
                : entry === "books"
                ? (item | as : BookModel).author
                : entry === "films"
                ? (item | as : FilmModel).director
                : null
            }}
          </h2>
          <h3 class="text-xl font-normal text-highlight">
            {{ item.genre }} | {{ item.year }} |
            {{
              entry === "albums"
                ? (item | as : AlbumModel).artist
                : entry === "books"
                ? (item | as : BookModel).pages + " pgs"
                : entry === "films"
                ? (item | as : FilmModel).runtime
                : null
            }}
          </h3>
        </div>
        <div>
          <div class="flex h-fit w-full flex-wrap items-end gap-x-px gap-y-1">
            <span
              *ngFor="let tag of item['tags'].sort()"
              class="hover-basic mr-1 cursor-default rounded-sm bg-secondary px-2 py-1 text-center text-lg font-semibold leading-none text-card opacity-80"
            >
              {{ tag }}
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="flex h-fit w-full justify-between">
      <span class="flex items-center gap-1 text-base font-light text-highlight">
        <ng-icon class="text-base" name="heroPlusCircleMini"></ng-icon>
        <span class="font-medium text-highlight">Adicionado em:</span
        >{{ addedAt | date : "d/MMMM/y 'às' h'h'mm'm'" }}
      </span>
      <span
        *ngIf="lastModified"
        class="flex items-center gap-1 text-base font-light text-highlight"
      >
        <ng-icon class="text-base" name="heroPencilSquareMini"></ng-icon>
        <span class="font-medium text-highlight">Última modificação em:</span
        >{{ lastModified | date : "d/MMMM/y 'às' h'h'mm'm'" }}
      </span>
    </div>
  </div>

  <!-- ############ -->
  <!-- ### Erro ## -->
  <!-- ############ -->
  <ng-template #loadingOrError>
    <div
      *ngIf="appState === 'error'"
      class="flex h-screen min-h-fit w-full flex-col items-center justify-center gap-5 p-2"
    >
      <img src="../../../assets/emptyWasteBin.png" alt="Empty waste bin" />
      <div class="flex flex-col justify-center">
        <h1 class="text-5xl font-extrabold text-secondary">OOOPS!</h1>
        <h2 class="text-2xl font-semibold text-highlight">
          O item especificado não foi encontrado na Biblioteca.
        </h2>
      </div>
    </div>
  </ng-template>
</div>
