<div class="flex flex-col">
  <div class="flex h-fit items-start">
    <img
      src="../../../assets/boxWithBooks.png"
      alt="cat on a bookshelf"
      class="h-full"
    />
    <div class="flex h-full w-full flex-col gap-5">
      <h1 class="text-5xl font-extrabold text-highlight">
        Adicione um novo {{ item }}!
      </h1>
      <p class="text-base text-detail">
        Adicione um novo {{ item }} para a biblioteca. Para isso, preencha os
        campos abaixo com as respectivas informações.
      </p>
      <div class="flex gap-2">
        <label class="text-2xl text-secondary" for="item"
          >Selecione o tipo do item:</label
        >
        <select
          id="item"
          (change)="onItemSelect($event)"
          class="h-fit w-1/2 border-b-2 border-highlight bg-main px-4 py-2 text-xl text-secondary"
        >
          <option value="item">nenhum item selecionado</option>
          <option *ngFor="let type of itemTypes" [value]="type">
            {{ type }}
          </option>
        </select>
      </div>
    </div>
  </div>
  <div>{{ mainForm.value | json }}</div>
  <!-- Main form -->
  <div class="flex h-fit w-full flex-col rounded bg-card p-5">
    <form
      [formGroup]="mainForm"
      class="flex flex-col items-center justify-center gap-2"
      #f="ngForm"
      (submit)="submitForm(f.value)"
    >
      <!-- Info -->
      <div class="flex w-full flex-col">
        <h2 class="text-3xl font-extrabold text-highlight">
          Informações Gerais
        </h2>
        <div class="m-1 flex flex-col justify-start gap-6">
          <!-- Group 1 -->
          <div class="flex w-full flex-wrap gap-2">
            <div class="m-1 flex grow items-end gap-4">
              <label class="text-2xl text-secondary" for="title">Título:</label>
              <input
                id="title"
                formControlName="title"
                type="text"
                class="h-fit w-full border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
          </div>

          <!-- Group 2 -->
          <div class="flex w-full flex-wrap gap-2">
            <div class="m-1 flex grow items-end gap-4">
              <label class="text-2xl text-secondary" for="author">Autor:</label>
              <input
                id="author"
                formControlName="author"
                type="text"
                class="h-fit w-full border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
          </div>

          <!-- Group 3 -->
          <div class="flex w-full flex-wrap gap-2">
            <div class="m-1 flex shrink grow items-end gap-4">
              <label class="text-2xl text-secondary" for="genre">Gênero:</label>
              <input
                id="genre"
                formControlName="genre"
                type="text"
                class="h-fit w-full border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
            <div class="m-1 flex grow-0 items-end gap-4">
              <label class="text-2xl text-secondary" for="year">Ano:</label>
              <input
                id="year"
                formControlName="year"
                type="text"
                class="h-fit w-28 border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
            <div class="m-1 flex grow-0 items-end gap-4">
              <label class="text-2xl text-secondary" for="pages"
                >Páginas:</label
              >
              <input
                id="pages"
                formControlName="pages"
                type="text"
                class="h-fit w-24 border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
          </div>
        </div>
      </div>
      <!-- Divider -->
      <div class="h-6 w-full border-b-2 border-dashed border-b-highlight"></div>
      <!-- Details -->
      <div class="flex flex-col">
        <h2 class="text-3xl font-extrabold text-highlight">Detalhes</h2>
        <div class="m-1 flex flex-wrap justify-start gap-6">
          <!-- Group 1 -->
          <div class="flex w-full flex-wrap gap-2">
            <div class="m-1 flex grow items-end gap-4">
              <label class="min-w-max text-2xl text-secondary" for="cover"
                >Capa: (url)</label
              >
              <input
                id="cover"
                formControlName="cover"
                type="text"
                class="h-fit w-full border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
          </div>
          <!-- Group 2 -->
          <div class="flex w-full items-end gap-2">
            <div class="m-1 flex grow items-end gap-4">
              <label class="min-w-max text-2xl text-secondary" for="collection"
                >Coleção</label
              >
              <input
                id="cover"
                formControlName="collection"
                type="text"
                class="h-fit w-full border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
              />
            </div>
            <div class="m-1 flex grow-0 items-end gap-4">
              <label class="text-2xl text-secondary" for="status"
                >Status:</label
              >
              <select
                id="status"
                formControlName="status"
                value=""
                class="h-fit w-40 border-b-2 border-highlight bg-card px-4 py-2 text-xl text-secondary"
              >
                <option *ngFor="let status of statusList" [value]="status">
                  {{ status }}
                </option>
              </select>
            </div>
            <app-star-rating [mainForm]="mainForm"></app-star-rating>
          </div>
          <!-- Group Array -->
          <div class="flex w-full flex-col gap-2" formGroupName="quotesForm">
            <div class="flex w-full flex-col gap-2" formArrayName="quotes">
              <div
                class="flex w-full flex-col gap-2 rounded bg-main px-5 py-3"
                *ngFor="let quote of quotes.controls; let i = index"
                [formGroupName]="i"
              >
                <div class="flex flex-col gap-2">
                  <label
                    class="text-xl font-bold text-highlight"
                    [for]="'quote_' + i"
                  >
                    Citação {{ i + 1 }}
                  </label>
                  <textarea
                    class="h-40 flex-grow resize-none overflow-x-hidden bg-main p-2 text-secondary focus:rounded focus:shadow-md focus:outline-none"
                    [id]="'quote_' + i"
                    formControlName="quote"
                    placeholder="Sua citação aqui"
                  ></textarea>
                </div>
                <div class="flex justify-between">
                  <div class="flex items-center gap-2">
                    <label
                      class="text-xl font-bold text-highlight"
                      [for]="'page_' + i"
                      >página:
                    </label>
                    <input
                      class="h-fit w-24 bg-main px-4 py-2 text-xl text-secondary focus:rounded focus:shadow-md focus:outline-none"
                      type="number"
                      [id]="'page_' + i"
                      formControlName="page"
                    />
                  </div>
                  <div class="flex items-center">
                    <button
                      class="rounded border-2 border-secondary px-2 py-px font-bold text-secondary"
                      type="button"
                      (click)="rmvQuote(i)"
                    >
                      Remover
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <button
              class="w-fit rounded border-2 border-highlight bg-card px-2 py-1 text-highlight hover:border-secondary hover:text-secondary"
              type="button"
              (click)="addQuote()"
            >
              Adicione uma citação
            </button>
          </div>
        </div>
      </div>
      <!-- Divider -->
      <div class="h-6 w-full border-b-2 border-dashed border-b-highlight"></div>
      <button
        class="w-fit self-start rounded bg-secondary px-3 py-2 text-card shadow-lg hover:bg-highlight"
        type="submit"
      >
        Adicionar {{ item }}
      </button>
    </form>
  </div>
</div>
